# **ğŸ§¬ Bone Marrow Single-Cell RNA-seq Analysis**

---

## **ğŸ“– Project Overview**
This project executes a reproducible analysis pipeline for **human bone marrow single-cell RNA-seq data** (`bone_marrow.h5ad`). The workflow utilizes **Scanpy** for preprocessing, clustering, and visualization. Due to environment constraints with automated tools, cell type annotation is performed via **manual mapping** based on canonical marker gene expression.

## **â“ Biological Questions**
1.  **Cell Composition:** Which specific cell types are present in this bone marrow sample?
2.  **Functional Roles:** What are the biological roles of each identified cluster?
3.  **Lineage Mapping:** Can we map major hematopoietic and immune cell populations (e.g., myeloid vs. lymphoid)?
4.  **Clinical Insight:** Can we assess the patient's immune status based on cell type proportions?

---

## **ğŸ“Š Dataset Information**

| Attribute | Details |
| :--- | :--- |
| **Source File** | `bone_marrow.h5ad` |
| **Dimensions** | **14,783** Cells Ã— **17,374** Genes |
| **Tissue** | Human Bone Marrow |
| **Metadata** | Disease stage, treatment, tissue type, QC metrics |

### **ğŸ“¥ Data Download**
*Due to file size limits, data is hosted externally.*

| Data Type | Filename | Link |
| :--- | :--- | :--- |
| **Raw Data** | `bone_marrow.h5ad` | [Download from Drive](https://drive.google.com/file/d/14O01KspPMehZ1i4V6ZrwZIzHwoudz-nk/view?usp=drive_link) |
| **Processed Data** | `bone_marrow_processed.h5ad` | [Download from Drive](https://drive.google.com/file/d/1mZMZ44--bOnzgC5-YwQE-AP8MxwbsUPo/view?usp=drive_link) |

> **Note:** The notebook automatically handles directory creation. Ensure you download the raw file into the `data/raw/` folder generated by the script.

---

## **ğŸ› ï¸ Environment & Setup**

### **Dependencies**
| Package | Usage |
| :--- | :--- |
| `scanpy` | Core single-cell analysis & plotting |
| `anndata` | Data structure storage |
| `python-igraph` | Fast graph-based clustering |
| `leidenalg` | Community detection algorithm |
| `pandas` | Data manipulation |
| `matplotlib` | Visualization |
| `seaborn` | Visualization |

### **Installation**
To reproduce this analysis:

1.  **Clone the repository:**
    ```bash
    git clone <repository_url>
    cd HackBio_Internship_SC_RNA-Seq_2025/Stage_Two/
    ```

2.  **Install requirements:**
    ```bash
    pip install scanpy anndata pandas matplotlib seaborn python-igraph leidenalg requests
    ```

3.  **Run the analysis:**
    Launch Jupyter and open `notebooks/bone_marrow_analysis.ipynb`.

---

## **âš™ï¸ Step-by-Step Workflow**

| Step | Task | Key Analytical Approach |
| :--- | :--- | :--- |
| **1** | **Data Loading** | Load `AnnData`; enforce unique gene/cell IDs. Auto-checks directory structure. |
| **2** | **Quality Control** | Calculate QC metrics (MT, RIBO, HB); visualize distributions; filter low-quality cells (<400 genes, >5% MT). |
| **3** | **Normalization** | Normalize to median total counts; log1p transformation; select top 1,000 Highly Variable Genes (HVGs) using Seurat flavor. |
| **4** | **Dim. Reduction** | PCA (Principal Component Analysis), Neighborhood Graph, and UMAP embedding. |
| **5** | **Clustering** | **Leiden clustering** at multiple resolutions (0.2, 0.5, 1.0, 2.0). Resolution **1.0** selected for annotation. |
| **6** | **Annotation** | **Manual Annotation:** Clusters mapped to biological identities using canonical markers (e.g., *CD3D* for T cells, *CD14* for Monocytes). |
| **7** | **Validation** | Visual confirmation via Dotplots and UMAP visualization. |

---

## **ğŸ”¬ Biological Insights**

### **1. Cell Type Annotation (`leiden_res1_0`)**
The analysis successfully resolved distinct myeloid and lymphoid populations.

| Cluster ID | Cell Type | Canonical Markers Used | Biological Role |
| :--- | :--- | :--- | :--- |
| **0** | **Neutrophils** | *ELANE, MPO* | First responders; innate immunity. |
| **1, 8** | **Gamma Delta T cells** | *TRDC* (Inferred) | Stress surveillance; bridging innate & adaptive immunity. |
| **2, 6** | **T Memory Cells** | *CD3D, IL7R* | Antigen recall; adaptive protection. |
| **3** | **NK Cells** | *GNLY, NKG7* | Cytotoxic activity; viral defense. |
| **4** | **B Cells (Memory)** | *MS4A1, CD27* | Humoral immunity; antibody memory. |
| **5** | **Platelets** | *PPBP, PF4* | Hemostasis and clotting. |
| **7** | **Plasma Cells** | *MZB1, JCHAIN* | Active antibody secretion. |
| **9** | **Monocytes** | *CD14, LYZ* | Inflammation; phagocytosis. |

### **2. Tissue Source Justification**
**Conclusion:** The sample is consistent with **Bone Marrow**.
* **Evidence:** Presence of **Neutrophils** (Cluster 0) and **Platelets** (Cluster 5), which are typically absent or low in processed PBMC samples, alongside a full spectrum of lymphocyte lineages.

### **3. Patient Immune Status Assessment**
The cell type composition suggests an **active immune response**.

* **Adaptive Activation:** High abundance of **T Memory Cells** (Clusters 2, 6) and **B Memory Cells** (Cluster 4).
* **Innate Response:** Distinct populations of **Neutrophils** and **NK cells**.
* **Antibody Production:** Presence of a dedicated **Plasma Cell** cluster (Cluster 7) indicates active humoral immunity.

---

## **ğŸ“‚ Directory Structure**

The notebook generates the following structure automatically:

```text
HackBio_Internship_SC_RNA-Seq_2025/
â””â”€â”€ Stage_Two/
    â”œâ”€â”€ notebooks/
    â”‚   â””â”€â”€ bone_marrow_analysis.ipynb   # Main analysis notebook
    â”œâ”€â”€ data/
    â”‚   â”œâ”€â”€ raw/
    â”‚   â”‚   â””â”€â”€ bone_marrow.h5ad         # Raw counts (User provided)
    â”‚   â””â”€â”€ processed/
    â”‚       â””â”€â”€ bone_marrow_processed.h5ad # Final annotated object
    â”œâ”€â”€ figures/
    â”‚   â”œâ”€â”€ _QC_metrics.png              # Violin plots of n_genes, counts, MT%
    â”‚   â”œâ”€â”€ _QC_scatter.png              # Scatter plot of MT vs Counts
    â”‚   â”œâ”€â”€ _dispersion.png              # Highly Variable Genes plot
    â”‚   â”œâ”€â”€ _variance_ratio.png          # PCA Variance
    â”‚   â”œâ”€â”€ _QC_check.png                # UMAP colored by QC metrics
    â”‚   â”œâ”€â”€ _Leiden_Resolutions.png      # UMAP of clusters (0.2 - 2.0)
    â”‚   â”œâ”€â”€ _Dotplot_CellType.png        # Expression of marker genes
    â”‚   â””â”€â”€ _Final_Annotation_UMAP.png   # Final annotated UMAP
    â””â”€â”€ bone_marrow_analysis.md